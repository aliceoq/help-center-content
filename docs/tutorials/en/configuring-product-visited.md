---
title: 'How to configure visited product'
id: tutorials_3136
status: PUBLISHED
createdAt: 2017-04-27T21:52:11.184Z
updatedAt: 2023-07-14T11:38:12.803Z
publishedAt: 2023-07-14T11:38:12.803Z
firstPublishedAt: 2017-04-27T23:03:54.918Z
contentType: tutorial
productTeam: Master Data
author: authors_3
slug: configuring-product-visited
locale: en
legacySlug: configuring-product-visited
subcategory: 2nx7hMJmisofwqwy2P9l2i
---

<div style="background-color:#FCF8F2; border-left: 2px solid #F0AD4E; border-top-left-radius: 2px; border-bottom-left-radius: 2px; padding: 15px; margin-bottom: 10px">
Tutorial valid only for Legacy CMS Stores.
</div>

Product visited is a function that sends emails to customers who viewed a product on your site but did not complete a purchase. The purpose of this email is to recover the sale, by sending details of the product abandoned and suggestions for others. You can do all this through your Master Data.

[![ExemploProdutoVisitado](//images.contentful.com/alneenqid6w5/3S5FjnFRl6SUoqAkIY84sI/1f6913ec8cd925c89906500a923de0c2/ExemploProdutoVisitado.png)](//images.contentful.com/alneenqid6w5/3S5FjnFRl6SUoqAkIY84sI/1f6913ec8cd925c89906500a923de0c2/ExemploProdutoVisitado.png "![ExemploProdutoVisitado](//images.contentful.com/alneenqid6w5/3S5FjnFRl6SUoqAkIY84sI/1f6913ec8cd925c89906500a923de0c2/ExemploProdutoVisitado.png)")

_For this feature to work properly, your store must have a high flow of visits and purchases, since the shelves are generated by relating browsing data to a specific product._

### Defining a minimum dispatch interval

Defining a minimum dispatch interval means fixing a minimum waiting time between sendings of emails to the same customer. This prevents the customer from receiving several emails during the same visit to the store.

To configure this interval, you must create a field in the **CL** entity**.**

1. In the VTEX Admin, access **Store Settings** > **Storefront** > **Master Data.**
2. In Master Data, click **Aplications** > **Data structure.**
3. Access the **Entidade de dados** tab.
4. Under the **Cliente **entity, click on the pencil symbol.
5. Click on the **Novo campo** button.

Complete the fields as shown below:
- **Nome**: lastTrigger
- **Nome de exibição**: Date last trigger sent
- **Tipo**: Date and Time

Click on the **Salvar** button.

### Showing the fields in the form

After creating a field in the entity, you have to configure it so that it appears in the form – this way it is possible to see the data registered in it. This is also valid for fields created automatically by VTEX which have not been marked for showing in the form. Below we give instructions on how to show the fields that are important in the case of a Product Visited.

1. Access the **Master Data **module;
2. In the application **Profile System**, click on the **gear** symbol; [![aplicacaoEditar](//images.contentful.com/alneenqid6w5/5EGLrHpiY8MOcEsUCUCaqS/7edf07ca138296670b0e2b7a0455bbef/aplicacaoEditar.png)](//images.contentful.com/alneenqid6w5/5EGLrHpiY8MOcEsUCUCaqS/7edf07ca138296670b0e2b7a0455bbef/aplicacaoEditar.png "![aplicacaoEditar](//images.contentful.com/alneenqid6w5/5EGLrHpiY8MOcEsUCUCaqS/7edf07ca138296670b0e2b7a0455bbef/aplicacaoEditar.png)")
3. Click on the **pencil** symbol over the **Cliente **form;
4. Click on the **Schemas de Layout **tab;
5. Click on the **Incluir Nova seção **button;
6. Give this section a name;
7. In the **Campos disponíveis** column, drag the field you want to the **Campos da coluna 1** area, below the name of the section created; [![arrastandoCampo](//images.contentful.com/alneenqid6w5/57Ridc88Te6kIo2CO4sOEI/80f6dd2602600841e62b666e88a2bd38/arrastandoCampo.png)](//images.contentful.com/alneenqid6w5/57Ridc88Te6kIo2CO4sOEI/80f6dd2602600841e62b666e88a2bd38/arrastandoCampo.png "![arrastandoCampo](//images.contentful.com/alneenqid6w5/57Ridc88Te6kIo2CO4sOEI/80f6dd2602600841e62b666e88a2bd38/arrastandoCampo.png)") [![arrastandoCampo2](//images.contentful.com/alneenqid6w5/4TQBONq7tKoEuEqCSoAS44/967247336bbb61ca775f7dd2488ae4f0/arrastandoCampo2.png)](//images.contentful.com/alneenqid6w5/4TQBONq7tKoEuEqCSoAS44/967247336bbb61ca775f7dd2488ae4f0/arrastandoCampo2.png "![arrastandoCampo2](//images.contentful.com/alneenqid6w5/4TQBONq7tKoEuEqCSoAS44/967247336bbb61ca775f7dd2488ae4f0/arrastandoCampo2.png)") [![seçãoCriada](//images.contentful.com/alneenqid6w5/6DwxZSd692YAweEwQs64C4/ed5a48459e501cf8f57ff180ba96dc73/se_C3_A7_C3_A3oCriada.png)](//images.contentful.com/alneenqid6w5/6DwxZSd692YAweEwQs64C4/ed5a48459e501cf8f57ff180ba96dc73/se_C3_A7_C3_A3oCriada.png "![seçãoCriada](//images.contentful.com/alneenqid6w5/6DwxZSd692YAweEwQs64C4/ed5a48459e501cf8f57ff180ba96dc73/se_C3_A7_C3_A3oCriada.png)")
8. Click on the **Salvar** button.

### Creating an email template

The template of the email to be sent, as for Abandoned Cart, is configured in the CMS module. For help with configuration, [use our model template](//assets.contentful.com/alneenqid6w5/6TloqmkC76AAauQ4e4SWmA/bf28c1d0d7d6618d5eb1231a578934f1/produtoVisitadoExemplo.html "use our model template").

1. Access the **CMS** module;
2. Click on **Portal**;
3. [Click here to download the model template](//assets.contentful.com/alneenqid6w5/6TloqmkC76AAauQ4e4SWmA/bf28c1d0d7d6618d5eb1231a578934f1/produtoVisitadoExemplo.html);
4. Click on **Templates de página**;
5. Click on **novo template**;
6. Enter the name and paste the code of your template. Attention: If you are using the model template, remember to change the `TEMPLATE_DE_PRATELEIRA` code for the id of your shelf template and the `NOME_DA_LOJA` code to the URL of your store.
7. Click on the **Salvar** button.

#### Understanding the products sent

Note that the control responsible for showing the product visited is `ProductQueryStringReferenceShelf` and that the control which will show the shelf(ves) of similar products is `&lt;vtex.cmc:productsCrossSelling` &#8230; `crossSellingType="1" /&gt;` with the parameter `crossSellingType` ranging from 1 to 6, as follows:

- **1**: People who viewed this item also viewed
- **2**: People who viewed this item also bought
- **3**: People who bought this item also bought
- **4**: Similar products
- **5**: Suggestions
- **6**: Accessories

The first three shelves are set up automatically by the system and the [three last ones are configured manually in the product registration](http://help.vtex.com/en/tutorial/setting-up-a-similar-product-suggestions-accessories-and-generics/).

#### Creating the folder structure

After creating the template, you must create the structure of folders necessary to configure the trigger. The step-by-step procedure is as follows:

1. Click on **Websites**;
2. Click on your store;
3. Click on the “ / “ folder;
4. Click on the **CEM** folder;
5. Click on new folder;

Complete the fields as shown below:

- **Nome da Pasta**: Produto-visitado
- **Protocolo**: HTTP
- **Requer Autenticação**: unchecked

Click on the **Salvar Pasta** button.

After creating a folder, associate the page template with the page layout.

1. Click on the folder created;
2. Click on **novo layout**;[![novoLayout](//images.contentful.com/alneenqid6w5/7x9hPRCKsgwOgk4iQ4IAsq/2eeb7573f284daf0429c7d129a8eaf26/novoLayout.png)](//images.contentful.com/alneenqid6w5/7x9hPRCKsgwOgk4iQ4IAsq/2eeb7573f284daf0429c7d129a8eaf26/novoLayout.png "![novoLayout](//images.contentful.com/alneenqid6w5/7x9hPRCKsgwOgk4iQ4IAsq/2eeb7573f284daf0429c7d129a8eaf26/novoLayout.png)")
3. Select the template created previously;
4. Click on the **Salvar** button.

### Configuring the email dispatch trigger

1. Access **nomedaloja**.ds.vtexcrm.com.br;
2. Click on the **Trigger **tab;
3. Click on the **Novo** button;
4. Enter the name of the trigger;
5. In **Status**, check **Ativo**;
6. In **Condição do trigger**, select **O valor de um atributo for alterado**;
7. In Informe o atributo, select Produto Visitado;

In **Filtro adicional**, configure as follows:
- **Checkout** Está nulo and
- **Produto Visitado** Não está nulo and

Click on the **Incluir grupo** button, then click on **Incluir filtro** and complete as follows:
- **Data do último trigger enviado** Menor ou igual `DATAL ATUAL` &#8211; `Subtrair dias` &#8211; `7` or
- **Data do último trigger enviado** Está nulo [![CondicoesTrigger](//images.contentful.com/alneenqid6w5/2fU6mJE1asQiQ4agmCSSaG/ff6148cbe2f6f07a8e01aea1ee0a68f1/CondicoesTrigger.png)](//images.contentful.com/alneenqid6w5/2fU6mJE1asQiQ4agmCSSaG/ff6148cbe2f6f07a8e01aea1ee0a68f1/CondicoesTrigger.png "![CondicoesTrigger](//images.contentful.com/alneenqid6w5/2fU6mJE1asQiQ4agmCSSaG/ff6148cbe2f6f07a8e01aea1ee0a68f1/CondicoesTrigger.png)")

Then, follow these steps:

1. Click on the **Agendamento **tab;
2. Select one of the dispatch options. E.g.: Schedule execution for a dynamic date, [DATA DATE] plus 2 hours;
3. Click on the **Ações em caso positive **tab;
4. In **Destinatário**, as a test, enter your email address and click on **Incluir e-mail estático**. After testing, delete your email address and select **Cliente: Email **and click on **Incluir e-mail dinâmico**;
5. In **Formato do corpo do e-mail**, select **HTML**;
6. In **Nome do remetente**, enter the name of your store;
7. In **E-mail de resposta**, enter the email address to which the customer can submit queries;
8. In **Origem do conteúdo**, select **Conteúdo de uma URL**;
9. Fill out the **Assunto** field;

In **URL**, enter the address of your store with the folders in which the layout of the abandoned shopping cart was configured. E.g.: **nomedaloja**.com.br/CEM/Produto-Visitado**?refp={!productVisitedTag}**;
Remember! Be sure that the ending **?refp={!productVisitedTag} **is at the end of the URL, so that the products will be shown.

In **Adicionar utm\_source em todos os links com valor**, enter “CEM”, to help identify the purchases by product visited. 

Finally, select **Sobrescrever utm\_source** and click on **Salvar**.

<iframe src="https://www.youtube.com/embed/c8bLByqTTzY" width="560" height="315" frameborder="0" allowfullscreen="allowfullscreen" data-mce-fragment="1"></iframe>
